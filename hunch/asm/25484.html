<!DOCTYPE html>
<html>
<head>
<title>Hunchback: Routine at 638C</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html">Hunchback</a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="25403.html">633B</a>
</td>
<td class="up">Up: <a href="../maps/all.html#25484">Map</a></td>
<td class="next">
Next: <a href="25629.html">641D</a>
</td>
</tr>
</table>
<div class="description">638C: Main loop (1)</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="25744.html">6490</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="25484"></span>638C</td>
<td class="instruction">LD A,($60B1)</td>
<td class="comment-1" rowspan="2">Does this level have a pit?</td>
</tr>
<tr>
<td class="address-1"><span id="25487"></span>638F</td>
<td class="instruction">CP $00</td>
</tr>
<tr>
<td class="address-1"><span id="25489"></span>6391</td>
<td class="instruction">JR NZ,$639F</td>
<td class="comment-1" rowspan="1">Jump forward if not.</td>
</tr>
<tr>
<td class="address-1"><span id="25491"></span>6393</td>
<td class="instruction">LD A,($60C4)</td>
<td class="comment-1" rowspan="2">Does this level have bells?</td>
</tr>
<tr>
<td class="address-1"><span id="25494"></span>6396</td>
<td class="instruction">CP $00</td>
</tr>
<tr>
<td class="address-1"><span id="25496"></span>6398</td>
<td class="instruction">JR NZ,$639F</td>
<td class="comment-1" rowspan="1">Jump forward if not.</td>
</tr>
<tr>
<td class="address-1"><span id="25498"></span>639A</td>
<td class="instruction">CALL <a href="26490.html">$677A</a></td>
<td class="comment-1" rowspan="2">Draw the bells and jump forward.</td>
</tr>
<tr>
<td class="address-1"><span id="25501"></span>639D</td>
<td class="instruction">JR $63A2</td>
</tr>
<tr>
<td class="address-2"><span id="25503"></span>639F</td>
<td class="instruction">CALL <a href="28874.html">$70CA</a></td>
<td class="comment-1" rowspan="1">Check for any collision.</td>
</tr>
<tr>
<td class="address-2"><span id="25506"></span>63A2</td>
<td class="instruction">LD A,($609F)</td>
<td class="comment-1" rowspan="2">Did Quasimodo collide or fall off anything?</td>
</tr>
<tr>
<td class="address-1"><span id="25509"></span>63A5</td>
<td class="instruction">CP $00</td>
</tr>
<tr>
<td class="address-1"><span id="25511"></span>63A7</td>
<td class="instruction">JP NZ,<a href="26673.html">$6831</a></td>
<td class="comment-1" rowspan="1">Jump forward if so to lose a life.</td>
</tr>
<tr>
<td class="address-1"><span id="25514"></span>63AA</td>
<td class="instruction">LD A,($60BF)</td>
<td class="comment-1" rowspan="2">Is Quasimodo on the rope?</td>
</tr>
<tr>
<td class="address-1"><span id="25517"></span>63AD</td>
<td class="instruction">CP $00</td>
</tr>
<tr>
<td class="address-1"><span id="25519"></span>63AF</td>
<td class="instruction">JP NZ,<a href="25629.html#25701">$6465</a></td>
<td class="comment-1" rowspan="1">Move forward if so.</td>
</tr>
<tr>
<td class="address-1"><span id="25522"></span>63B2</td>
<td class="instruction">LD A,($607F)</td>
<td class="comment-1" rowspan="3">Is Quasimodo's Y co-ordinate near an object?</td>
</tr>
<tr>
<td class="address-1"><span id="25525"></span>63B5</td>
<td class="instruction">LD HL,$6082</td>
</tr>
<tr>
<td class="address-1"><span id="25528"></span>63B8</td>
<td class="instruction">CP (HL)</td>
</tr>
<tr>
<td class="address-1"><span id="25529"></span>63B9</td>
<td class="instruction">JR NZ,$63CE</td>
<td class="comment-1" rowspan="1">Jump forward if not.</td>
</tr>
<tr>
<td class="address-1"><span id="25531"></span>63BB</td>
<td class="instruction">LD HL,$6083</td>
<td class="comment-1" rowspan="3">Is Quasimodo's X co-ordinate near an object?</td>
</tr>
<tr>
<td class="address-1"><span id="25534"></span>63BE</td>
<td class="instruction">LD A,($6080)</td>
</tr>
<tr>
<td class="address-1"><span id="25537"></span>63C1</td>
<td class="instruction">CP (HL)</td>
</tr>
<tr>
<td class="address-1"><span id="25538"></span>63C2</td>
<td class="instruction">JR NZ,$63CE</td>
<td class="comment-1" rowspan="1">Jump forward if not.</td>
</tr>
<tr>
<td class="address-1"><span id="25540"></span>63C4</td>
<td class="instruction">LD HL,$6084</td>
<td class="comment-1" rowspan="3">Is Quasimodo's sub-frame near an object?</td>
</tr>
<tr>
<td class="address-1"><span id="25543"></span>63C7</td>
<td class="instruction">LD A,($6081)</td>
</tr>
<tr>
<td class="address-1"><span id="25546"></span>63CA</td>
<td class="instruction">CP (HL)</td>
</tr>
<tr>
<td class="address-1"><span id="25547"></span>63CB</td>
<td class="instruction">JP Z,<a href="25744.html">$6490</a></td>
<td class="comment-1" rowspan="1">Jump forward if so and see if there was a collision.</td>
</tr>
<tr>
<td class="address-2"><span id="25550"></span>63CE</td>
<td class="instruction">NOP</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="25551"></span>63CF</td>
<td class="instruction">LD A,($60C5)</td>
<td class="comment-1" rowspan="2">Has Quasimodo grabbed a bell?</td>
</tr>
<tr>
<td class="address-1"><span id="25554"></span>63D2</td>
<td class="instruction">CP $00</td>
</tr>
<tr>
<td class="address-1"><span id="25556"></span>63D4</td>
<td class="instruction">JR Z,$63E0</td>
<td class="comment-1" rowspan="1">Jump forward if so.</td>
</tr>
<tr>
<td class="address-1"><span id="25558"></span>63D6</td>
<td class="instruction">LD A,($60C6)</td>
<td class="comment-1" rowspan="2">Do objects need updating?</td>
</tr>
<tr>
<td class="address-1"><span id="25561"></span>63D9</td>
<td class="instruction">CP $01</td>
</tr>
<tr>
<td class="address-1"><span id="25563"></span>63DB</td>
<td class="instruction">JP Z,<a href="25744.html">$6490</a></td>
<td class="comment-1" rowspan="1">Jump forward if so.</td>
</tr>
<tr>
<td class="address-1"><span id="25566"></span>63DE</td>
<td class="instruction">JR $63E8</td>
<td class="comment-1" rowspan="1">Otherwise continue.</td>
</tr>
<tr>
<td class="address-2"><span id="25568"></span>63E0</td>
<td class="instruction">LD A,($60C6)</td>
<td class="comment-1" rowspan="2">Do objects need updating when Quasimodo is on a bell?</td>
</tr>
<tr>
<td class="address-1"><span id="25571"></span>63E3</td>
<td class="instruction">CP $01</td>
</tr>
<tr>
<td class="address-1"><span id="25573"></span>63E5</td>
<td class="instruction">JP Z,<a href="28275.html">$6E73</a></td>
<td class="comment-1" rowspan="1">Jump forward if so.</td>
</tr>
<tr>
<td class="address-2"><span id="25576"></span>63E8</td>
<td class="instruction">LD A,($6083)</td>
<td class="comment-1" rowspan="18">Draw the next object.</td>
</tr>
<tr>
<td class="address-1"><span id="25579"></span>63EB</td>
<td class="instruction">LD E,A</td>
</tr>
<tr>
<td class="address-1"><span id="25580"></span>63EC</td>
<td class="instruction">LD A,($6082)</td>
</tr>
<tr>
<td class="address-1"><span id="25583"></span>63EF</td>
<td class="instruction">LD D,A</td>
</tr>
<tr>
<td class="address-1"><span id="25584"></span>63F0</td>
<td class="instruction">LD A,($6084)</td>
</tr>
<tr>
<td class="address-1"><span id="25587"></span>63F3</td>
<td class="instruction">LD C,A</td>
</tr>
<tr>
<td class="address-1"><span id="25588"></span>63F4</td>
<td class="instruction">LD A,$04</td>
</tr>
<tr>
<td class="address-1"><span id="25590"></span>63F6</td>
<td class="instruction">CALL <a href="47000.html">$B798</a></td>
</tr>
<tr>
<td class="address-1"><span id="25593"></span>63F9</td>
<td class="instruction">LD A,($6083)</td>
</tr>
<tr>
<td class="address-1"><span id="25596"></span>63FC</td>
<td class="instruction">LD E,A</td>
</tr>
<tr>
<td class="address-1"><span id="25597"></span>63FD</td>
<td class="instruction">LD A,($6082)</td>
</tr>
<tr>
<td class="address-1"><span id="25600"></span>6400</td>
<td class="instruction">ADD A,$10</td>
</tr>
<tr>
<td class="address-1"><span id="25602"></span>6402</td>
<td class="instruction">LD D,A</td>
</tr>
<tr>
<td class="address-1"><span id="25603"></span>6403</td>
<td class="instruction">LD A,($6084)</td>
</tr>
<tr>
<td class="address-1"><span id="25606"></span>6406</td>
<td class="instruction">ADD A,$04</td>
</tr>
<tr>
<td class="address-1"><span id="25608"></span>6408</td>
<td class="instruction">LD C,A</td>
</tr>
<tr>
<td class="address-1"><span id="25609"></span>6409</td>
<td class="instruction">LD A,$04</td>
</tr>
<tr>
<td class="address-1"><span id="25611"></span>640B</td>
<td class="instruction">CALL <a href="47000.html">$B798</a></td>
</tr>
<tr>
<td class="address-1"><span id="25614"></span>640E</td>
<td class="instruction">LD A,($60C5)</td>
<td class="comment-1" rowspan="2">Has Quasimodo grabbed a bell?</td>
</tr>
<tr>
<td class="address-1"><span id="25617"></span>6411</td>
<td class="instruction">CP $00</td>
</tr>
<tr>
<td class="address-1"><span id="25619"></span>6413</td>
<td class="instruction">JR Z,<a href="25629.html">$641D</a></td>
<td class="comment-1" rowspan="1">If not, re-draw</td>
</tr>
<tr>
<td class="address-1"><span id="25621"></span>6415</td>
<td class="instruction">LD A,$01</td>
<td class="comment-1" rowspan="2">Mark objects as needing updating.</td>
</tr>
<tr>
<td class="address-1"><span id="25623"></span>6417</td>
<td class="instruction">LD ($60C6),A</td>
</tr>
<tr>
<td class="address-1"><span id="25626"></span>641A</td>
<td class="instruction">JP <a href="28229.html">$6E45</a></td>
<td class="comment-1" rowspan="1">Jump forward.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="25403.html">633B</a>
</td>
<td class="up">Up: <a href="../maps/all.html#25484">Map</a></td>
<td class="next">
Next: <a href="25629.html">641D</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright"></div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.10.</div>
</footer>
</body>
</html>