<!DOCTYPE html>
<html>
<head>
<title>Dynamite Dan: Routine at C800</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html">Dynamite Dan</a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="51190.html">C7F6</a>
</td>
<td class="up">Up: <a href="../maps/all.html#51200">Map</a></td>
<td class="next">
Next: <a href="51302.html">C866</a>
</td>
</tr>
</table>
<div class="description">C800: Main entry point</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="51200"></span>C800</td>
<td class="instruction">DI</td>
<td class="comment-1" rowspan="1">Disable interrupts.</td>
</tr>
<tr>
<td class="address-1"><span id="51201"></span>C801</td>
<td class="instruction">LD SP,$FFFF</td>
<td class="comment-1" rowspan="1">Put the stack somewhere safe.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="51204"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routines at <a href="52691.html">CDD3</a> and <a href="58927.html">E62F</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="51204"></span>C804</td>
<td class="instruction">CALL <a href="51803.html">$CA5B</a></td>
<td class="comment-1" rowspan="1">Display the intro screen and wait for a game to start.</td>
</tr>
<tr>
<td class="address-1"><span id="51207"></span>C807</td>
<td class="instruction">CALL <a href="51329.html">$C881</a></td>
<td class="comment-1" rowspan="1">Start the game.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="51210"></span>
<div class="comments">
<div class="paragraph">
Main loop starts here
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="51210"></span>C80A</td>
<td class="instruction">CALL <a href="55788.html">$D9EC</a></td>
<td class="comment-1" rowspan="1">Update the raft.</td>
</tr>
<tr>
<td class="address-1"><span id="51213"></span>C80D</td>
<td class="instruction">CALL <a href="58770.html">$E592</a></td>
<td class="comment-1" rowspan="1">Move all objects in the room.</td>
</tr>
<tr>
<td class="address-1"><span id="51216"></span>C810</td>
<td class="instruction">CALL <a href="59711.html">$E93F</a></td>
<td class="comment-1" rowspan="1">Toggle the colours on test tubes and dynamite.</td>
</tr>
<tr>
<td class="address-1"><span id="51219"></span>C813</td>
<td class="instruction">CALL <a href="53209.html">$CFD9</a></td>
<td class="comment-1" rowspan="1">Update Dan and check for movement.</td>
</tr>
<tr>
<td class="address-1"><span id="51222"></span>C816</td>
<td class="instruction">CALL <a href="61308.html">$EF7C</a></td>
<td class="comment-1" rowspan="1">Draw any glowing objects.</td>
</tr>
<tr>
<td class="address-1"><span id="51225"></span>C819</td>
<td class="instruction">CALL <a href="52361.html">$CC89</a></td>
<td class="comment-1" rowspan="1">Move the lift.</td>
</tr>
<tr>
<td class="address-1"><span id="51228"></span>C81C</td>
<td class="instruction">CALL <a href="51498.html">$C92A</a></td>
<td class="comment-1" rowspan="1">Update the main status area.</td>
</tr>
<tr>
<td class="address-1"><span id="51231"></span>C81F</td>
<td class="instruction">CALL <a href="55949.html">$DA8D</a></td>
<td class="comment-1" rowspan="1">Play any sound effects.</td>
</tr>
<tr>
<td class="address-1"><span id="51234"></span>C822</td>
<td class="instruction">CALL <a href="52319.html">$CC5F</a></td>
<td class="comment-1" rowspan="1">Animate the river.</td>
</tr>
<tr>
<td class="address-1"><span id="51237"></span>C825</td>
<td class="instruction">CALL <a href="58856.html">$E5E8</a></td>
<td class="comment-1" rowspan="1">Launch the blimp if Dan is in it with the plans.</td>
</tr>
<tr>
<td class="address-1"><span id="51240"></span>C828</td>
<td class="instruction">CALL <a href="58979.html">$E663</a></td>
<td class="comment-1" rowspan="1">Update any teleporters.</td>
</tr>
<tr>
<td class="address-1"><span id="51243"></span>C82B</td>
<td class="instruction">CALL <a href="59100.html">$E6DC</a></td>
<td class="comment-1" rowspan="1">Update any lasers in the room.</td>
</tr>
<tr>
<td class="address-1"><span id="51246"></span>C82E</td>
<td class="instruction">CALL <a href="52909.html">$CEAD</a></td>
<td class="comment-1" rowspan="1">Perform any special actions in the room.</td>
</tr>
<tr>
<td class="address-1"><span id="51249"></span>C831</td>
<td class="instruction">CALL <a href="56914.html">$DE52</a></td>
<td class="comment-1" rowspan="1">Update aerosol immunity.</td>
</tr>
<tr>
<td class="address-1"><span id="51252"></span>C834</td>
<td class="instruction">LD BC,$0400</td>
<td class="comment-1" rowspan="2">Pause for a time so the game has the right speed.</td>
</tr>
<tr>
<td class="address-1"><span id="51255"></span>C837</td>
<td class="instruction">CALL <a href="54447.html">$D4AF</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="51258"></span>
<div class="comments">
<div class="paragraph">
Pause the game if "P" was pressed
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="51258"></span>C83A</td>
<td class="instruction">LD A,$DF</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="51260"></span>C83C</td>
<td class="instruction">IN A,($FE)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="51262"></span>C83E</td>
<td class="instruction">RRA</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="51263"></span>C83F</td>
<td class="instruction">JR C,$C858</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="51265"></span>C841</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="51266"></span>C842</td>
<td class="instruction">IN A,($FE)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="51268"></span>C844</td>
<td class="instruction">CPL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="51269"></span>C845</td>
<td class="instruction">AND $1F</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="51271"></span>C847</td>
<td class="instruction">JR NZ,$C841</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="51273"></span>C849</td>
<td class="instruction">LD A,$DF</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="51275"></span>C84B</td>
<td class="instruction">IN A,($FE)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="51277"></span>C84D</td>
<td class="instruction">RRA</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="51278"></span>C84E</td>
<td class="instruction">JR C,$C849</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="51280"></span>C850</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="51281"></span>C851</td>
<td class="instruction">IN A,($FE)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="51283"></span>C853</td>
<td class="instruction">CPL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="51284"></span>C854</td>
<td class="instruction">AND $1F</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="51286"></span>C856</td>
<td class="instruction">JR NZ,$C850</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="51288"></span>
<div class="comments">
<div class="paragraph">
Abort the game if "Q" was pressed
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="51288"></span>C858</td>
<td class="instruction">LD A,$FB</td>
<td class="comment-1" rowspan="2">Get 'Q' - 'T' keys.</td>
</tr>
<tr>
<td class="address-1"><span id="51290"></span>C85A</td>
<td class="instruction">IN A,($FE)</td>
</tr>
<tr>
<td class="address-1"><span id="51292"></span>C85C</td>
<td class="instruction">RRA</td>
<td class="comment-1" rowspan="2">Jump to the beginning of the routine if 'Q' was pressed.</td>
</tr>
<tr>
<td class="address-1"><span id="51293"></span>C85D</td>
<td class="instruction">JR C,$C80A</td>
</tr>
<tr>
<td class="address-1"><span id="51295"></span>C85F</td>
<td class="instruction">LD HL,$C87F</td>
<td class="comment-1" rowspan="2">Set the laser to fire.</td>
</tr>
<tr>
<td class="address-1"><span id="51298"></span>C862</td>
<td class="instruction">SET 7,(HL)</td>
</tr>
<tr>
<td class="address-1"><span id="51300"></span>C864</td>
<td class="instruction">JR $C804</td>
<td class="comment-1" rowspan="1">Run the main loop again.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="51190.html">C7F6</a>
</td>
<td class="up">Up: <a href="../maps/all.html#51200">Map</a></td>
<td class="next">
Next: <a href="51302.html">C866</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">Copyright Rod Bowkett / Mirrorsoft 1985. This dissassembly by Ritchie Swann 2019-2023.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.10.</div>
</footer>
</body>
</html>