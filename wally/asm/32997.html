<!DOCTYPE html>
<html>
<head>
<title>Everyone's A Wally: Routine at 80E5</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="loading" src="../images/loading.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="32937.html">80A9</a>
</td>
<td class="up">Up: <a href="../maps/all.html#32997">Map</a></td>
<td class="next">
Next: <a href="33082.html">813A</a>
</td>
</tr>
</table>
<div class="description">80E5: Show title screen</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routines at <a href="33109.html">8155</a> and <a href="33156.html">8184</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="32997"></span>
<div class="comments">
<div class="paragraph">
The routine returns when the user starts a game.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="32997"></span>80E5</td>
<td class="instruction">CALL Clear_Screen</td>
<td class="comment-1" rowspan="1">Clear the screen.</td>
</tr>
<tr>
<td class="address-1"><span id="33000"></span>80E8</td>
<td class="instruction">CALL Init_Theme_Tune</td>
<td class="comment-1" rowspan="1">Initialize the theme tune data.</td>
</tr>
<tr>
<td class="address-2"><span id="33003"></span>80EB</td>
<td class="instruction">LD HL,Title_Text</td>
<td class="comment-1" rowspan="3">Print the title page text. (<a href="32198.html">7DC6</a>)</td>
</tr>
<tr>
<td class="address-1"><span id="33006"></span>80EE</td>
<td class="instruction">LD DE,$0003</td>
</tr>
<tr>
<td class="address-1"><span id="33009"></span>80F1</td>
<td class="instruction">CALL Print_Char</td>
</tr>
<tr>
<td class="address-1"><span id="33012"></span>80F4</td>
<td class="instruction">LD HL,Key_Text</td>
<td class="comment-1" rowspan="1">Point <span class="register">HL</span> at the "key" text. (<a href="32311.html">7E37</a>)</td>
</tr>
<tr>
<td class="address-1"><span id="33015"></span>80F7</td>
<td class="instruction">LD A,(Input_Method)</td>
<td class="comment-1" rowspan="2">Put the current control mechanism (<a href="45787.html">B2DB</a>) in <span class="register">B</span>.</td>
</tr>
<tr>
<td class="address-1"><span id="33018"></span>80FA</td>
<td class="instruction">LD B,A</td>
</tr>
<tr>
<td class="address-1"><span id="33019"></span>80FB</td>
<td class="instruction">LD A,$02</td>
<td class="comment-1" rowspan="9">Convert this to a location on screen and put it in <span class="register">DE</span>.</td>
</tr>
<tr>
<td class="address-1"><span id="33021"></span>80FD</td>
<td class="instruction">SUB B</td>
</tr>
<tr>
<td class="address-1"><span id="33022"></span>80FE</td>
<td class="instruction">LD B,A</td>
</tr>
<tr>
<td class="address-1"><span id="33023"></span>80FF</td>
<td class="instruction">ADD A,A</td>
</tr>
<tr>
<td class="address-1"><span id="33024"></span>8100</td>
<td class="instruction">ADD A,A</td>
</tr>
<tr>
<td class="address-1"><span id="33025"></span>8101</td>
<td class="instruction">ADD A,A</td>
</tr>
<tr>
<td class="address-1"><span id="33026"></span>8102</td>
<td class="instruction">SUB B</td>
</tr>
<tr>
<td class="address-1"><span id="33027"></span>8103</td>
<td class="instruction">LD D,A</td>
</tr>
<tr>
<td class="address-1"><span id="33028"></span>8104</td>
<td class="instruction">LD E,$03</td>
</tr>
<tr>
<td class="address-1"><span id="33030"></span>8106</td>
<td class="instruction">CALL Print_Char</td>
<td class="comment-1" rowspan="1">Print a marker against the selected option.</td>
</tr>
<tr>
<td class="address-2"><span id="33033"></span>8109</td>
<td class="instruction">LD A,$FF</td>
<td class="comment-1" rowspan="2">Set to no key pressed.</td>
</tr>
<tr>
<td class="address-1"><span id="33035"></span>810B</td>
<td class="instruction">LD (Last_Key),A</td>
</tr>
<tr>
<td class="address-1"><span id="33038"></span>810E</td>
<td class="instruction">CALL <a href="46210.html">$B482</a></td>
<td class="comment-1" rowspan="1">Play the next note of the theme tune.</td>
</tr>
<tr>
<td class="address-1"><span id="33041"></span>8111</td>
<td class="instruction">LD A,(Is_Character_Computer)</td>
<td class="comment-1" rowspan="2">Is the tune still playing?</td>
</tr>
<tr>
<td class="address-1"><span id="33044"></span>8114</td>
<td class="instruction">OR A</td>
</tr>
<tr>
<td class="address-1"><span id="33045"></span>8115</td>
<td class="instruction">JR NZ,Run_Demo</td>
<td class="comment-1" rowspan="1">If not, start demo mode.</td>
</tr>
<tr>
<td class="address-1"><span id="33047"></span>8117</td>
<td class="instruction">LD A,(Last_Key)</td>
<td class="comment-1" rowspan="1">Get the last key pressed.</td>
</tr>
<tr>
<td class="address-1"><span id="33050"></span>811A</td>
<td class="instruction">BIT 0,A</td>
<td class="comment-1" rowspan="1">Was '1' pressed?</td>
</tr>
<tr>
<td class="address-1"><span id="33052"></span>811C</td>
<td class="instruction">JR NZ,$8123</td>
<td class="comment-1" rowspan="1">Jump forward if not.</td>
</tr>
<tr>
<td class="address-1"><span id="33054"></span>811E</td>
<td class="instruction">CALL <a href="45788.html">$B2DC</a></td>
<td class="comment-1" rowspan="2">Select Sinclair control and continue playing the tune.</td>
</tr>
<tr>
<td class="address-1"><span id="33057"></span>8121</td>
<td class="instruction">JR $80EB</td>
</tr>
<tr>
<td class="address-2"><span id="33059"></span>8123</td>
<td class="instruction">BIT 1,A</td>
<td class="comment-1" rowspan="1">Was '2' pressed?</td>
</tr>
<tr>
<td class="address-1"><span id="33061"></span>8125</td>
<td class="instruction">JR NZ,$812C</td>
<td class="comment-1" rowspan="1">Jump forward if not.</td>
</tr>
<tr>
<td class="address-1"><span id="33063"></span>8127</td>
<td class="instruction">CALL <a href="45794.html">$B2E2</a></td>
<td class="comment-1" rowspan="2">Select Kempston control and continue playing the tune.</td>
</tr>
<tr>
<td class="address-1"><span id="33066"></span>812A</td>
<td class="instruction">JR $80EB</td>
</tr>
<tr>
<td class="address-2"><span id="33068"></span>812C</td>
<td class="instruction">BIT 2,A</td>
<td class="comment-1" rowspan="1">Was '3' pressed?</td>
</tr>
<tr>
<td class="address-1"><span id="33070"></span>812E</td>
<td class="instruction">JR NZ,$8135</td>
<td class="comment-1" rowspan="1">Jump forward if not.</td>
</tr>
<tr>
<td class="address-1"><span id="33072"></span>8130</td>
<td class="instruction">CALL <a href="45800.html">$B2E8</a></td>
<td class="comment-1" rowspan="2">Select Keyboard control and continue playing the tune.</td>
</tr>
<tr>
<td class="address-1"><span id="33075"></span>8133</td>
<td class="instruction">JR $80EB</td>
</tr>
<tr>
<td class="address-2"><span id="33077"></span>8135</td>
<td class="instruction">BIT 3,A</td>
<td class="comment-1" rowspan="1">Was '4' pressed?</td>
</tr>
<tr>
<td class="address-1"><span id="33079"></span>8137</td>
<td class="instruction">JR NZ,$8109</td>
<td class="comment-1" rowspan="1">Jump back if not to continue playing the tune.</td>
</tr>
<tr>
<td class="address-1"><span id="33081"></span>8139</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Otherwise return to start the game.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="32937.html">80A9</a>
</td>
<td class="up">Up: <a href="../maps/all.html#32997">Map</a></td>
<td class="next">
Next: <a href="33082.html">813A</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">(c) 1985 Mikro-Gen (code and graphics), 2013-2023 Ritchie Swann / Paul Maddern (this disassembly)</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 9.0.</div>
</footer>
</body>
</html>