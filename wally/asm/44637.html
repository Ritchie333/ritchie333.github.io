<!DOCTYPE html>
<html>
<head>
<title>Everyone's A Wally: Routine at AE5D</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html">Everyone's A Wally</a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="44604.html">AE3C</a>
</td>
<td class="up">Up: <a href="../maps/all.html#44637">Map</a></td>
<td class="next">
Next: <a href="44682.html">AE8A</a>
</td>
</tr>
</table>
<div class="description">AE5D: Get the new room and co-ordinates for a computer controlled player.</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routines at <a href="43698.html">AAB2</a>, <a href="43741.html">AADD</a>, <a href="43785.html">AB09</a>, <a href="43814.html">AB26</a>, <a href="43843.html">AB43</a>, <a href="43872.html">AB60</a> and <a href="43931.html">AB9B</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="44637"></span>AE5D</td>
<td class="instruction">LD A,(IY+$0F)</td>
<td class="comment-1" rowspan="2">Set the current room to the most recently visited room.</td>
</tr>
<tr>
<td class="address-1"><span id="44640"></span>AE60</td>
<td class="instruction">LD (IY+$6E),A</td>
</tr>
<tr>
<td class="address-1"><span id="44643"></span>AE63</td>
<td class="instruction">LD A,(IY+$69)</td>
<td class="comment-1" rowspan="2">Set the target room as the current room.</td>
</tr>
<tr>
<td class="address-1"><span id="44646"></span>AE66</td>
<td class="instruction">LD (IY+$0F),A</td>
</tr>
<tr>
<td class="address-1"><span id="44649"></span>AE69</td>
<td class="instruction">LD A,(IY+$73)</td>
<td class="comment-1" rowspan="1">Get the index of next co-ordinates to use. (<a href="48346.html">BCDA</a>)</td>
</tr>
<tr>
<td class="address-1"><span id="44652"></span>AE6C</td>
<td class="instruction">CALL <a href="44127.html">$AC5F</a></td>
<td class="comment-1" rowspan="1">Point <span class="register">HL</span> at the co-ordinate table to use.</td>
</tr>
<tr>
<td class="address-1"><span id="44655"></span>AE6F</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="2">Set the new x co-ordinate.</td>
</tr>
<tr>
<td class="address-1"><span id="44656"></span>AE70</td>
<td class="instruction">LD (IY+$05),A</td>
</tr>
<tr>
<td class="address-1"><span id="44659"></span>AE73</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="3">Set the new y co-ordinate.</td>
</tr>
<tr>
<td class="address-1"><span id="44660"></span>AE74</td>
<td class="instruction">LD A,(HL)</td>
</tr>
<tr>
<td class="address-1"><span id="44661"></span>AE75</td>
<td class="instruction">LD (IY+$0A),A</td>
</tr>
<tr>
<td class="address-1"><span id="44664"></span>AE78</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="2">Set the current frame to 0.</td>
</tr>
<tr>
<td class="address-1"><span id="44665"></span>AE79</td>
<td class="instruction">LD (IY+$00),A</td>
</tr>
<tr>
<td class="address-1"><span id="44668"></span>AE7C</td>
<td class="instruction">CALL <a href="44474.html">$ADBA</a></td>
<td class="comment-1" rowspan="1">Update the character.</td>
</tr>
<tr>
<td class="address-1"><span id="44671"></span>AE7F</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="1">Set <span class="register">A</span> to 0 to set some flags.</td>
</tr>
<tr>
<td class="address-1"><span id="44672"></span>AE80</td>
<td class="instruction">LD (IY+$37),A</td>
<td class="comment-1" rowspan="1">Set the character as on the ground (ie: not falling)</td>
</tr>
<tr>
<td class="address-1"><span id="44675"></span>AE83</td>
<td class="instruction">LD (IY+$3C),A</td>
<td class="comment-1" rowspan="1">Set the character to not jumping.</td>
</tr>
<tr>
<td class="address-1"><span id="44678"></span>AE86</td>
<td class="instruction">LD (IY+$46),A</td>
<td class="comment-1" rowspan="1">Set the character to not jumping in any direction.</td>
</tr>
<tr>
<td class="address-1"><span id="44681"></span>AE89</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="44604.html">AE3C</a>
</td>
<td class="up">Up: <a href="../maps/all.html#44637">Map</a></td>
<td class="next">
Next: <a href="44682.html">AE8A</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">(c) 1985 Mikro-Gen (code and graphics), 2013-2023 Ritchie Swann / Paul Maddern (this disassembly)</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.10.</div>
</footer>
</body>
</html>